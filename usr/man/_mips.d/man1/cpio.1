.\" SCCSID: @(#)cpio.1	8.2	4/10/91
.TH cpio 1
.SH Name
cpio \- copy file archives in and out
.SH Syntax
.B cpio
.B \-i \fR[ \fB\-C\fR ]  
[\|\fIkeys\fR\|]
[\|\fIpatterns\fR\|] 
.PP
.B cpio
.B \-o
[\|\fIkeys\fR\|]
.PP
.B cpio
.B \-p
[\|\fIkeys\fR\|]
.I directory
.SH Description
.NXR "cpio command"
.NXR "archive file" "copying"
.NXR "cpio command" "ar command"
The 
.PN cpio
command is a filter designed to let you copy files to or from an
archive.  The
.PN cpio 
command
differs from the
.PN ar
command in that
.PN cpio
lets you archive any kind of file, while
.PN ar
is limited to program object files.
.SH Options
.NXR "cpio command" "options"
.TP 5
.B \-i
Copies files that match the specified pattern.  If the pattern is not specified,
copies in all files.
Extracts files from the
standard input,
which is assumed to be the product of a previous
.BR "cpio \-o" ,
and places them into the user's current directory tree.
For files with the same name, the newer file replaces
the older file unless the \fB\-u\fR option is used.
.sp
.RS 5
Only files with names that match
.I patterns\^
are selected.
The
.I patterns\^
are specified using the notation for names described
in 
.MS sh 1 .
In
.I patterns,
the slash for directories (/) is included in searches using
meta-characters.
For example, suppose the archive contains the file
.PN filep 
and the pathname information in the archive indicates
that the directory below contains the file 
.PN file2p .
This command 
copies both files into the user's current directory:
.EX
cpio \-i *p < /dev/rmt0l
.EE
.PP
Multiple
.I patterns\^
may be specified and
if no
.I patterns\^
are specified, the default for
.I patterns\^
is
.BR \(**
(that is, select all files).
The extracted files are conditionally created and copied
into the current directory tree
based upon the options described below.
The 
.PN cpio
command has three function keys, each with its own set
of options.
.RE
.TP 5
.B \-C
Specifies compatability mode for reading 
.PN cpio 
archives 
created with the old style header format.  
Use this option to
copy in 
.PN cpio 
archives generated by pre-V4.2 
.MS cpio 1 .
This
option is valid only for copy-in (\fB\-i\fR) operations.
.TP 5
.B \-o
Copies out the specified files.  Reads the standard input to obtain a list 
of path names and copies those files onto the standard output
together with path name and status information.
.TP
.B \-p
Copies files into the specified destination directory, which must already exist.
Reads the standard input to obtain a list of path names
of files that are conditionally created.  This list of
files is copied 
into the destination
.I directory
tree based upon the options used.  For files with the
same name, the newer file replaces the older file unless
the \fB\-u\fR option is used.
.SH Keys
.NXR "cpio command" "function keys"
.TP 5
.B 6
Processes a file with the 
UNIX
System
Sixth
Edition format.
.TP
.B a
Retains original access times of input files, and can be used with
.B \-o
and 
.B \-p.  
Normally, the read(s) used in the copy update the copied file's access time.
.TP
.B B
Determines input/output is to be blocked 5,120 bytes to the record.
This option is meaningful only with data directed to or from
.PN /dev/rmt?h
or
.PN /dev/rmt?l .
.TP
.B b
Swaps both bytes and halfwords.
.TP
.B c
Creates header information in ASCII format and can be used with
.B \-i
and 
.B \-o.
.TP
.B d
Creates subdirectories, as needed, below the specified
destination directory.
.TP
.B f
Copies all files except those that match the specified pattern.  
.TP
.B k
Enables symbolic link handling and is used with the 
.B \-i,
.B \-o,
and
.B \-p
options.
.TP
.B l
Creates links wherever possible.  
.TP
.B m
Retains modification time for each copied file.  This option does
not work on directories or symbolic links
that are being copied; the directory
is always reset to show the access time when the copy was made.
.TP
.B r
Interactively
renames
files.
If you respond with a null line, the
file is skipped (not copied).  Use only with the \fB\-i\fR
option.
.TP
.B s
Swaps bytes while copying files in.
.TP
.B S
Swaps half words while copying files in.  
.TP
.B t
Prints a
table of contents
of the input (no files are created).
.TP
.B u
Copies files unconditionally.  
(Otherwise, an older file will not replace a newer 
file with the same name).
.TP
.B v
Displays detailed (verbose) information as it copies and/or creates file.  
When used with
the
.B t
option,
the table of contents looks like the output of an
.B ls\ \|\-l
command.  For further information,
see
.MS ls 1 .
.SH Examples
.NXR "cpio command"
This example shows how to copy the contents of the user's
current directory
into an archive.
.EX
ls | cpio \-o  > /dev/rmt0l
.EE
This example shows how to duplicate a directory hierarchy.
.EX
mkdir ~phares/newdir
cd ~phares/olddir
find . \-print | cpio \-pdl ~phares/newdir
.EE
This example shows how to copy all files and directories
with names containing the characters "chapter" in user 
smith's
home directory and underlying directories.
.EX
find ~smith \-name '*chapter*' \-print | cpio \-o > /dev/rmt0h
.EE
This example shows the results of using the \fBr\fR
option with the \fB\-i\fR function key.
.EX
ls | cpio \-ir > ~smith/newdir
Rename <file1>
newnamefile1
Rename <file2>
<RETURN>
Skipped
Rename <file3>
newnamefile3
.EE
In some cases, the \fB\-cpio\fR option of the
.PN find
command can be used more effectively than pipes and
redirects using
.PN cpio.  
For instance, the following example
.EX 
find . \-print | cpio \-oB > /dev/rmt0l
.EE
can be handled more efficiently by:
.EX
find . \-cpio /dev/rmt0l
.EE
To copy the contents of a directory (with symbolic link handling
enabled) to the tape drive, type:
.EX
ls | cpio \-ok > /dev/rmt0h
.EE
To restore the archived files back into a directory, type:
.EX
cpio \-ik < /dev/rmt0h
.EE
The following example moves files, including symbolic links, from an 
old directory to a new directory:
.EX
mkdir ~craig/newdir
cd ~craig/olddir
ls | cpio \-pdk ~craig/newdir
.EE
.SH Restrictions
.NXR "cpio command" "restricted"
Pathnames are restricted to 128 characters.
.PP
When there are too many unique linked files,
the program runs out of
memory and cannot trace them.  In this case, linking information is lost.
.PP
Only the superuser can copy special files.
.SH See Also
ar(1), find(1), cpio(5)
.NXR "cpio command"
.NXR "archive file" "copying"
